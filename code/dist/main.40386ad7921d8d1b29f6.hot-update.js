"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_hexlet_code"]("main",{

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bootstrap/dist/css/bootstrap.min.css */ \"./node_modules/bootstrap/dist/css/bootstrap.min.css\");\n/* harmony import */ var bootstrap_dist_js_bootstrap_bundle_min_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bootstrap/dist/js/bootstrap.bundle.min.js */ \"./node_modules/bootstrap/dist/js/bootstrap.bundle.min.js\");\n/* harmony import */ var _styles_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./styles.css */ \"./src/styles.css\");\n/* harmony import */ var _i18n_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./i18n.js */ \"./src/i18n.js\");\n/* harmony import */ var _validation_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./validation.js */ \"./src/validation.js\");\n/* harmony import */ var _view_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./view.js */ \"./src/view.js\");\n/* harmony import */ var _rssService_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./rssService.js */ \"./src/rssService.js\");\n/* harmony import */ var _dataStore_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./dataStore.js */ \"./src/dataStore.js\");\n/* harmony import */ var _feedUpdater_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./feedUpdater.js */ \"./src/feedUpdater.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regenerator() { /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ var e, t, r = \"function\" == typeof Symbol ? Symbol : {}, n = r.iterator || \"@@iterator\", o = r.toStringTag || \"@@toStringTag\"; function i(r, n, o, i) { var c = n && n.prototype instanceof Generator ? n : Generator, u = Object.create(c.prototype); return _regeneratorDefine2(u, \"_invoke\", function (r, n, o) { var i, c, u, f = 0, p = o || [], y = !1, G = { p: 0, n: 0, v: e, a: d, f: d.bind(e, 4), d: function d(t, r) { return i = t, c = 0, u = e, G.n = r, a; } }; function d(r, n) { for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) { var o, i = p[t], d = G.p, l = i[2]; r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0)); } if (o || r > 1) return a; throw y = !0, n; } return function (o, p, l) { if (f > 1) throw TypeError(\"Generator is already running\"); for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) { i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u); try { if (f = 2, i) { if (c || (o = \"next\"), t = i[o]) { if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\"); if (!t.done) return t; u = t.value, c < 2 && (c = 0); } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1); i = e; } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break; } catch (t) { i = e, c = 1, u = t; } finally { f = 1; } } return { value: t, done: y }; }; }(r, o, i), !0), u; } var a = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} t = Object.getPrototypeOf; var c = [][n] ? t(t([][n]())) : (_regeneratorDefine2(t = {}, n, function () { return this; }), t), u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c); function f(e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, _regeneratorDefine2(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, _regeneratorDefine2(u, \"constructor\", GeneratorFunctionPrototype), _regeneratorDefine2(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", _regeneratorDefine2(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), _regeneratorDefine2(u), _regeneratorDefine2(u, o, \"Generator\"), _regeneratorDefine2(u, n, function () { return this; }), _regeneratorDefine2(u, \"toString\", function () { return \"[object Generator]\"; }), (_regenerator = function _regenerator() { return { w: i, m: f }; })(); }\nfunction _regeneratorDefine2(e, r, n, t) { var i = Object.defineProperty; try { i({}, \"\", {}); } catch (e) { i = 0; } _regeneratorDefine2 = function _regeneratorDefine(e, r, n, t) { function o(r, n) { _regeneratorDefine2(e, r, function (e) { return this._invoke(r, n, e); }); } r ? i ? i(e, r, { value: n, enumerable: !t, configurable: !t, writable: !t }) : e[r] = n : (o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2)); }, _regeneratorDefine2(e, r, n, t); }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\n\n\n\n\n\n\n\n\n\n\n// Initialize the application\nvar initApp = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3() {\n    var watchedState, form, input, languageDropdown, updateUITexts, startButton, stopButton, statusButton;\n    return _regenerator().w(function (_context3) {\n      while (1) switch (_context3.n) {\n        case 0:\n          _context3.n = 1;\n          return (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n        case 1:\n          // Initialize DOM elements\n          (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.initElements)();\n\n          // Create watched state\n          watchedState = (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.createWatchedState)(); // Get form elements\n          form = document.getElementById('rss-form');\n          input = document.getElementById('rss-url');\n          if (!(!form || !input)) {\n            _context3.n = 2;\n            break;\n          }\n          console.error('Required form elements not found');\n          return _context3.a(2);\n        case 2:\n          // Real-time URL validation\n          input.addEventListener('input', /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n            var url, rssUrlSchema, existingFeeds, isDuplicate, _t;\n            return _regenerator().w(function (_context) {\n              while (1) switch (_context.p = _context.n) {\n                case 0:\n                  url = input.value.trim();\n                  if (url) {\n                    _context.n = 1;\n                    break;\n                  }\n                  watchedState.form.isValid = true;\n                  watchedState.form.errors = [];\n                  _context.n = 4;\n                  break;\n                case 1:\n                  _context.p = 1;\n                  rssUrlSchema = (0,_validation_js__WEBPACK_IMPORTED_MODULE_4__.createRssUrlSchema)(_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t);\n                  _context.n = 2;\n                  return rssUrlSchema.validate(url, {\n                    abortEarly: false\n                  });\n                case 2:\n                  // Check for duplicate URL in real-time\n                  existingFeeds = _dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.getAllFeeds();\n                  console.log('Real-time validation - existing feeds:', existingFeeds.length);\n                  console.log('Real-time validation - current URL:', url);\n                  isDuplicate = existingFeeds.some(function (feed) {\n                    return feed.originalUrl === url || feed.link === url;\n                  });\n                  console.log('Real-time validation - is duplicate?', isDuplicate);\n                  if (isDuplicate) {\n                    console.log('Duplicate detected in real-time validation, showing alert with text:', (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('validation.duplicateUrl'));\n                    (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.showError)((0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('validation.duplicateUrl'));\n                    watchedState.form.isValid = false;\n                    watchedState.form.errors = [(0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('validation.duplicateUrl')];\n                  } else {\n                    watchedState.form.isValid = true;\n                    watchedState.form.errors = [];\n                  }\n                  _context.n = 4;\n                  break;\n                case 3:\n                  _context.p = 3;\n                  _t = _context.v;\n                  if (_t.errors) {\n                    watchedState.form.isValid = false;\n                    watchedState.form.errors = _t.errors;\n                  } else {\n                    watchedState.form.isValid = false;\n                    watchedState.form.errors = [_t.message];\n                  }\n                case 4:\n                  return _context.a(2);\n              }\n            }, _callee, null, [[1, 3]]);\n          })));\n\n          // Form submission with full validation\n          form.addEventListener('submit', /*#__PURE__*/function () {\n            var _ref3 = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(e) {\n              var url, rssUrlSchema, existingFeeds, isDuplicate, result, feedData, postsData, feedId, feed, posts, errorMessage, _t2;\n              return _regenerator().w(function (_context2) {\n                while (1) switch (_context2.p = _context2.n) {\n                  case 0:\n                    e.preventDefault();\n                    url = input.value.trim();\n                    console.log('Form submitted with URL:', url);\n                    if (url) {\n                      _context2.n = 1;\n                      break;\n                    }\n                    watchedState.form.isValid = false;\n                    watchedState.form.errors = [(0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('validation.required')];\n                    return _context2.a(2);\n                  case 1:\n                    // Set submitting state\n                    watchedState.form.isSubmitting = true;\n                    watchedState.form.url = url;\n                    _context2.p = 2;\n                    // Basic URL validation first\n                    rssUrlSchema = (0,_validation_js__WEBPACK_IMPORTED_MODULE_4__.createRssUrlSchema)(_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t);\n                    _context2.n = 3;\n                    return rssUrlSchema.validate(url, {\n                      abortEarly: false\n                    });\n                  case 3:\n                    // Check for duplicate URL\n                    existingFeeds = _dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.getAllFeeds();\n                    console.log('Checking for duplicates. Existing feeds:', existingFeeds.map(function (f) {\n                      return {\n                        originalUrl: f.originalUrl,\n                        link: f.link\n                      };\n                    }));\n                    console.log('Current URL:', url);\n                    isDuplicate = existingFeeds.some(function (feed) {\n                      return feed.originalUrl === url || feed.link === url;\n                    });\n                    console.log('Is duplicate?', isDuplicate);\n                    if (!isDuplicate) {\n                      _context2.n = 4;\n                      break;\n                    }\n                    console.log('Duplicate detected, showing error alert');\n                    (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.showError)((0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('validation.duplicateUrl'));\n                    watchedState.form.isSubmitting = false;\n                    return _context2.a(2);\n                  case 4:\n                    _context2.n = 5;\n                    return _rssService_js__WEBPACK_IMPORTED_MODULE_6__.rssService.fetchAndParseFeed(url);\n                  case 5:\n                    result = _context2.v;\n                    console.log('RSS service result:', result);\n\n                    // Extract feed and posts from result\n                    console.log('Result structure check:', {\n                      hasResult: !!result,\n                      hasFeed: !!(result && result.feed),\n                      hasPosts: !!(result && result.posts),\n                      resultKeys: result ? Object.keys(result) : 'no result'\n                    });\n                    feedData = result && result.feed ? result.feed : result;\n                    postsData = result && result.posts ? result.posts : [];\n                    console.log('Feed data:', feedData);\n                    console.log('Posts data:', postsData);\n\n                    // Validate feedData before passing to dataStore\n                    if (!(!feedData || _typeof(feedData) !== 'object')) {\n                      _context2.n = 6;\n                      break;\n                    }\n                    throw new Error('Invalid feed data structure received from RSS service');\n                  case 6:\n                    // Add to data store\n                    feedId = _dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.addFeed(feedData, postsData);\n                    console.log('Feed added to dataStore. All feeds now:', _dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.getAllFeeds().map(function (f) {\n                      return {\n                        id: f.id,\n                        originalUrl: f.originalUrl,\n                        link: f.link\n                      };\n                    }));\n\n                    // Get feed and posts for display\n                    feed = _dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.getFeed(feedId);\n                    posts = _dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.getFeedPosts(feedId); // Display feed with posts\n                    (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.displayFeed)(feed, posts);\n                    console.log('About to call showSuccess with message:', (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.success'));\n                    (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.showSuccess)((0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.success'));\n\n                    // Start feed updater if this is the first feed\n                    if (_dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.getAllFeeds().length === 1) {\n                      _feedUpdater_js__WEBPACK_IMPORTED_MODULE_8__.feedUpdater.start();\n                      console.log((0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.updaterStarted'));\n                    }\n\n                    // Reset form\n                    watchedState.form.url = '';\n                    watchedState.form.isValid = true;\n                    watchedState.form.errors = [];\n                    _context2.n = 8;\n                    break;\n                  case 7:\n                    _context2.p = 7;\n                    _t2 = _context2.v;\n                    console.error('Form submission error:', _t2);\n                    console.error('Error stack:', _t2.stack);\n                    console.error('Error message:', _t2.message);\n\n                    // Handle different types of errors\n                    if (_t2.errors) {\n                      // Yup validation errors\n                      watchedState.form.isValid = false;\n                      watchedState.form.errors = _t2.errors;\n                    } else {\n                      // Network, parsing, or other errors\n                      errorMessage = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.unexpectedError');\n                      if (_t2.message.includes('timeout') || _t2.message.includes('taking too long')) {\n                        errorMessage = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.timeout');\n                      } else if (_t2.message.includes('Network error') || _t2.message.includes('unable to reach')) {\n                        errorMessage = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.networkError');\n                      } else if (_t2.message.includes('parsing') || _t2.message.includes('RSS') || _t2.message.includes('XML') || _t2.message.includes('HTML')) {\n                        errorMessage = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.invalidFormat');\n                      } else if (_t2.message.includes('server responded')) {\n                        errorMessage = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.networkError');\n                      }\n                      (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.showError)(errorMessage);\n                    }\n                  case 8:\n                    _context2.p = 8;\n                    // Reset submitting state\n                    watchedState.form.isSubmitting = false;\n                    // Clear form\n                    input.value = '';\n                    return _context2.f(8);\n                  case 9:\n                    return _context2.a(2);\n                }\n              }, _callee2, null, [[2, 7, 8, 9]]);\n            }));\n            return function (_x) {\n              return _ref3.apply(this, arguments);\n            };\n          }());\n\n          // Language switcher functionality\n          languageDropdown = document.getElementById('languageDropdown'); // Update UI texts when language changes\n          updateUITexts = function updateUITexts() {\n            // Update form elements\n            var urlLabel = document.querySelector('label[for=\"rss-url\"]');\n            var urlInput = document.getElementById('rss-url');\n            var urlHelp = document.querySelector('.form-text');\n            var submitButton = document.querySelector('button[type=\"submit\"]');\n            if (urlLabel) urlLabel.textContent = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.form.urlLabel');\n            if (urlInput) urlInput.placeholder = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.form.urlPlaceholder');\n            if (urlHelp) urlHelp.textContent = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.form.urlHelp');\n            if (submitButton) {\n              submitButton.textContent = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.form.submitButton');\n            }\n\n            // Update language dropdown button\n            var currentLang = (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.getCurrentLanguage)();\n            if (languageDropdown) {\n              var langCode = currentLang.toUpperCase();\n              languageDropdown.innerHTML = \"\\uD83C\\uDF10 \".concat(langCode);\n            }\n          }; // Handle language change\n          document.querySelectorAll('[data-lang]').forEach(function (link) {\n            link.addEventListener('click', function (e) {\n              e.preventDefault();\n              var lang = e.target.dataset.lang;\n              console.log('Language change requested:', lang);\n              (0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.changeLanguage)(lang).then(function () {\n                console.log('Language changed, updating UI texts');\n                updateUITexts();\n                // Force a small delay for Firefox to process the change\n                setTimeout(function () {\n                  updateUITexts();\n                }, 100);\n              });\n            });\n          });\n\n          // Feed updater control buttons\n          startButton = document.getElementById('start-updates');\n          stopButton = document.getElementById('stop-updates');\n          statusButton = document.getElementById('update-status');\n          if (startButton) {\n            startButton.addEventListener('click', function () {\n              _feedUpdater_js__WEBPACK_IMPORTED_MODULE_8__.feedUpdater.start();\n              startButton.disabled = true;\n              stopButton.disabled = false;\n              (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.showSuccess)((0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.updaterStarted'));\n            });\n          }\n          if (stopButton) {\n            stopButton.addEventListener('click', function () {\n              _feedUpdater_js__WEBPACK_IMPORTED_MODULE_8__.feedUpdater.stop();\n              startButton.disabled = false;\n              stopButton.disabled = true;\n              (0,_view_js__WEBPACK_IMPORTED_MODULE_5__.showSuccess)((0,_i18n_js__WEBPACK_IMPORTED_MODULE_3__.t)('app.messages.updaterStopped'));\n            });\n          }\n          if (statusButton) {\n            statusButton.addEventListener('click', function () {\n              var stats = _feedUpdater_js__WEBPACK_IMPORTED_MODULE_8__.feedUpdater.getStats();\n              var message = \"Updates: \".concat(stats.isRunning ? 'Running' : 'Stopped', \" | Cycles: \").concat(stats.updateCount, \" | Feeds: \").concat(_dataStore_js__WEBPACK_IMPORTED_MODULE_7__.dataStore.getAllFeeds().length);\n              alert(message);\n            });\n          }\n\n          // Request notification permission on page load\n          if ('Notification' in window) {\n            _feedUpdater_js__WEBPACK_IMPORTED_MODULE_8__.feedUpdater.constructor.requestNotificationPermission();\n          }\n\n          // Initial UI text update\n          updateUITexts();\n        case 3:\n          return _context3.a(2);\n      }\n    }, _callee3);\n  }));\n  return function initApp() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\n// Initialize when DOM is loaded\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', initApp);\n} else {\n  initApp();\n}\n\n//# sourceURL=webpack://@hexlet/code/./src/index.js?\n}");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("05b725e92fed6fa4e72f")
/******/ })();
/******/ 
/******/ }
);